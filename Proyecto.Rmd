---
title: "Laboratorio 1"
author: "Joshua Cervantes/Moisés Monge"
date: "`r format(Sys.time(), '%d %B %Y')`"
mail: "joshua.cervantes@ucr.ac.cr"
linkedin: ""
twitter: ""
github: "afr063426"

home: ""
# !!! You need to provide a logo image here !!! Or just delete the field for no logo
logo: ""
output:
  prettydoc::html_pretty:
      theme: cayman
      highlight: github
      math: katex
      toc: true
      toc_depth: 2
      code_menu: true

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, width = 60)
## Packages that are needed
library(devtools)
library(prettydoc)
library(rmarkdown)
library(tidyverse)
library(kableExtra)
library(jcolors)
library(xtable)
options(scipen = 999, digits = 5, OutDec = ",")



#We comment beacuse only is needed to create the table
#used with all the stations
#---------------------------------------
# We write all the tables

#list_documents <- unlist(list.files(path="PRSA_Data_20130301-20170228",all.file=TRUE,full.names=TRUE))[-(1:2)]

#We proceed to join all in an unique file
#data <- read.csv(list_documents[1])
#for(i in list_documents[-1]){
#    aux <- read.csv(i)
#    data <- rbind(data,aux)
#}

#We write a document with all the stations
#write.csv(data, "datos.csv")
#-----------------------------------------
#We read the documento
data <- read.csv("datos.csv")

stations <- unique(data$station)
```


```{r Table_Head}
#We create a table in format latex for the work

head_first_5 <- head(data, n=5)

print(xtable(head_first_5, type = "latex", tabular.environment="longtable"),
    include.rownames=FALSE, file = "head_5.tex")

```


```{r Summary_5}
#We create the summary of five numbers for 
#We select only the numeric kind
numeric_cols <- data%>%select_if(is.numeric)

#We select the first numeric that is considered important
n_col_PM2.5 <- which(colnames(numeric_cols)=="PM2.5")

#We select the last numeric that is considered important
n_col_WSPM <- which(colnames(numeric_cols)=="WSPM")


names_cols <- colnames(numeric_cols)

summary_5_number <- data.frame("Variable" = character(),
                "Mínimo"=numeric(), 
                "Q1"=numeric(),
                "Mediana"=numeric(),
                "Q3"=numeric(),
                "Máximo"=numeric()
                )


#Summary 5 numberts taking information of twelve stations
summary_data_frame <- function(dat){
    quantiles <- quantile(dat, na.rm = TRUE)
    quantiles <- data.frame("Mínimo"=quantiles[1], 
                "Q1"=quantiles[2],
                "Mediana"=quantiles[3],
                "Q3"=quantiles[4],
                "Máximo"=quantiles[5])
    return(quantiles)
}




for(i in n_col_PM2.5:n_col_WSPM){
    aux <- cbind("Variable" = names_cols[i], summary_data_frame(numeric_cols[i]))
    summary_5_number <- rbind(summary_5_number, aux)
}
#Data frame to long format


print(xtable(summary_5_number, type = "latex", tabular.environment="longtable"),
    include.rownames=FALSE, file = "summary_5_number.tex")


#We create a summary of five numbers for PM2.5 grouping by station

summary_2.5_station <- data.frame("Estación" = character(),
                "Mínimo"=numeric(), 
                "Q1"=numeric(),
                "Mediana"=numeric(),
                "Q3"=numeric(),
                "Máximo"=numeric()
                )
for(i in stations){
    PM2.5_aux <- data%>%filter(station == i)%>%select(PM2.5)
    aux <- cbind("Estación" = i, summary_data_frame(PM2.5_aux))
    summary_2.5_station <- rbind(summary_2.5_station, aux)
}
print(xtable(summary_2.5_station, type = "latex", tabular.environment="longtable"),
    include.rownames=FALSE, file = "summary_2.5_station.tex")

```